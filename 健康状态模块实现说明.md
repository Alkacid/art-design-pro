# 健康管理系统 - 健康状态模块实现说明

## 📋 概述

本次实现了健康管理系统的两个核心模块：

- **健康状态展示页面** (`status`): 展示用户健康数据的趋势图表
- **健康数据更新页面** (`update`): 用于录入新的健康数据

## 📁 文件结构

```
src/
├── types/store/
│   └── health.d.ts                         # 健康数据类型定义
├── store/modules/
│   └── health.ts                           # 健康数据 Store (Pinia)
└── views/healthStatus/
    ├── status/
    │   └── index.vue                       # 健康状态展示页面
    └── update/
        └── index.vue                       # 健康数据更新页面
```

## 🎯 功能特性

### 1. 数据存储 (Store)

**文件**: `src/store/modules/health.ts`

**功能**:

- ✅ 使用 Pinia 进行状态管理
- ✅ 支持数据持久化到 localStorage
- ✅ 提供完整的 CRUD 操作
- ✅ 支持按时间范围筛选数据
- ✅ 自动计算统计数据（平均值、趋势等）
- ✅ 内置示例数据生成（用于开发测试）

**主要方法**:

- `addRecord()`: 添加健康记录
- `updateRecord()`: 更新记录
- `deleteRecord()`: 删除记录
- `getRecordsByTimeRange()`: 按时间范围获取记录
- `getStatistics()`: 获取统计数据
- `initSampleData()`: 初始化示例数据

### 2. 健康状态展示页面

**文件**: `src/views/healthStatus/status/index.vue`

**功能**:

- ✅ 时间范围筛选（近7天、近30天、近90天、全部）
- ✅ 统计摘要卡片（平均体重、血压、血糖）
- ✅ 体重变化趋势（显示增减）
- ✅ 三个趋势图表：
  - 体重趋势图（蓝色折线图，带渐变背景）
  - 血压趋势图（收缩压和舒张压双折线）
  - 血糖趋势图（橙色折线图，带渐变背景）
- ✅ 最近记录列表（最多显示10条）
- ✅ 响应式设计，支持移动端

**使用的图表组件**:

- `ArtLineChart`: 来自 `src/components/core/charts/art-line-chart`
- 支持多种配置：颜色、渐变背景、图例、数据点样式等

### 3. 健康数据更新页面

**文件**: `src/views/healthStatus/update/index.vue`

**功能**:

- ✅ 完整的数据录入表单
  - 记录时间（日期时间选择器）
  - 体重（kg）
  - 体脂率（%）
  - 收缩压（mmHg）
  - 舒张压（mmHg）
  - 血糖（mmol/L）
  - 备注
- ✅ 表单验证
  - 数值范围验证
  - 血压逻辑验证（收缩压 > 舒张压）
  - 至少填写一项数据的验证
- ✅ 健康指标参考值卡片（BMI、血压、血糖标准）
- ✅ 保存后自动跳转到状态页面
- ✅ 响应式设计

## 💾 数据模型

### HealthRecord (健康记录)

```typescript
interface HealthRecord {
  id: string // 记录ID
  date: string // 记录日期时间（ISO格式）
  weight?: number // 体重（kg）
  systolicPressure?: number // 收缩压（mmHg）
  diastolicPressure?: number // 舒张压（mmHg）
  bloodSugar?: number // 血糖（mmol/L）
  bodyFat?: number // 体脂率（%）
  note?: string // 备注
}
```

### HealthStatistics (统计数据)

```typescript
interface HealthStatistics {
  avgWeight?: number // 平均体重
  avgSystolicPressure?: number // 平均收缩压
  avgDiastolicPressure?: number // 平均舒张压
  avgBloodSugar?: number // 平均血糖
  weightTrend?: number // 体重变化趋势
}
```

## 🎨 UI 设计特点

1. **卡片布局**: 使用 Element Plus 的 `ElCard` 组件，视觉清晰
2. **颜色方案**:
   - 体重图表: 蓝色 (#409eff)
   - 血压图表: 红色 (#f56c6c) + 绿色 (#67c23a)
   - 血糖图表: 橙色 (#e6a23c)
3. **响应式网格**: 使用 `ElRow` 和 `ElCol` 实现响应式布局
4. **暗黑模式兼容**: 使用 CSS 变量，自动适配主题

## 🚀 使用方法

### 1. 访问页面

```
/healthStatus/status   - 查看健康状态
/healthStatus/update   - 更新健康数据
```

### 2. 示例数据

首次访问 `status` 页面时，如果没有数据，会自动生成过去30天的示例数据。

### 3. 在组件中使用 Store

```typescript
import { useHealthStore } from '@/store/modules/health'

const healthStore = useHealthStore()

// 添加记录
healthStore.addRecord({
  date: new Date().toISOString(),
  weight: 70.5,
  systolicPressure: 120,
  diastolicPressure: 80,
  bloodSugar: 5.6
})

// 获取统计数据
const stats = healthStore.getStatistics('30d')

// 获取最新记录
const latest = healthStore.getLatestRecord
```

## 📊 数据持久化

所有健康数据使用 Pinia 的持久化插件自动保存到浏览器的 localStorage 中，刷新页面后数据不会丢失。

**存储键**: `healthStore` (通过 StorageKeyManager 管理)

## 🔄 后续扩展建议

1. **数据导出**: 支持导出为 CSV 或 Excel
2. **数据导入**: 支持从文件导入历史数据
3. **目标设置**: 设置减重目标，显示进度
4. **健康评估**: 根据 BMI、血压等数据给出健康建议
5. **AI 建议**: 接入 AI 生成个性化健康计划
6. **数据共享**: 与医生共享数据
7. **提醒功能**: 定时提醒用户记录数据
8. **更多指标**: 支持更多健康指标（心率、睡眠、运动等）

## 🛠️ 技术栈

- **框架**: Vue 3 (Composition API)
- **状态管理**: Pinia
- **UI 组件**: Element Plus
- **图表**: ECharts (通过 ArtLineChart 封装)
- **类型检查**: TypeScript
- **样式**: SCSS

## 📝 注意事项

1. 所有数据目前存储在前端 localStorage，生产环境需要对接后端 API
2. 示例数据仅用于开发测试，实际使用时可以移除
3. 图表组件已从仓库提供的组件中选择，保持了一致的设计风格
4. 所有表单输入都有合理的验证和限制
5. 页面完全响应式，支持各种屏幕尺寸

## ✅ 完成状态

- ✅ 类型定义文件
- ✅ 健康数据 Store
- ✅ 健康状态展示页面
- ✅ 健康数据更新页面

所有功能已实现并可以正常使用！
